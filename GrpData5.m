AttachSpec("spec");
X := GSpLattice(4,5,0);
#X;
// assert #X eq 330;
G := GSp(4,5); #G;
CCs := ConjugacyClasses(G);
phi := ClassMap(G);

L := Setseq(Keys(X));
Xsubs := [lbl eq "1.1.1" select GSp(4,5) else X[lbl]`subgroup : lbl in L];
dat1 := [GSpCharpolsDistribution(H) : H in Xsubs];
dat2 := [GSpGassmannDistribution(H : CCs := CCs, phi := phi) : H in Xsubs];

sdat1 := SequenceToSet(dat1); #sdat1;
// 143
msdat1 := SequenceToMultiset(dat1);
dat1_dups := [<x,n> : x in sdat1 | n gt 1 where n is Multiplicity(msdat1,x)];
[x[2] : x in dat1_dups];
// [ 3, 2, 34, 15, 5, 3, 7, 2, 5, 3, 2, 4, 2, 2, 2, 6, 8, 2, 3, 3, 2, 3, 2, 2, 5, 6, 2, 2, 2, 3, 6, 3, 2, 20, 2, 29, 5, 4, 2, 6, 6, 2 ]

sdat2 := SequenceToSet(dat2); #sdat2;
// 278
msdat2 := SequenceToMultiset(dat2);
dat2_dups := [<x,n> : x in sdat2 | n gt 1 where n is Multiplicity(msdat2,x)];
[x[2] : x in dat2_dups];
// [ 2, 2, 2, 2, 4, 3, 2, 2, 4, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2 ]

//////////////////////////////////////////////////////////////////////////////

L := [lbl : lbl in Setseq(Keys(X)) | lbl eq "1.1.1" or exists(cc){cc[3] : cc in ConjugacyClasses(H) | cc[1] eq 2 and GSpSimilitudeCharacter(cc[3]) eq -1} where H is X[lbl]`subgroup];
Xsubs := [lbl eq "1.1.1" select GSp(4,5) else X[lbl]`subgroup : lbl in L];
#Xsubs;
// 1125
dat1 := [GSpCharpolsDistribution(H) : H in Xsubs];
dat2 := [GSpGassmannDistribution(H : CCs := CCs, phi := phi) : H in Xsubs];

sdat1 := SequenceToSet(dat1); #sdat1;
// 258
msdat1 := SequenceToMultiset(dat1);
dat1_dups := [<x,n> : x in sdat1 | n gt 1 where n is Multiplicity(msdat1,x)];
{* x[2] : x in dat1_dups *};
// {* 2^^40, 3^^16, 4^^17, 5^^23, 6^^5, 7^^10, 8^^5, 9^^2, 10, 11^^3, 15, 17, 20, 21^^4, 26^^3, 30^^2, 36, 37, 45^^2, 57 *}

sdat2 := SequenceToSet(dat2); #sdat2;
// 773
msdat2 := SequenceToMultiset(dat2);
dat2_dups := [<x,n> : x in sdat2 | n gt 1 where n is Multiplicity(msdat2,x)];
{* x[2] : x in dat2_dups *};
// {* 2^^240, 3^^6, 4^^21, 5, 6, 8^^4 *}

Gassmanndups_lbls := [L[[i : i in [1..#dat2] | dat2[i] eq dat]] : dat in Set(dat2) | Multiplicity(dat2,dat) gt 1];
{*#x : x in Gassmanndups_lbls *};
// {* 2^^240, 3^^6, 4^^21, 5, 6, 8^^4 *}
Gassmanndups_lbls;
/*
[
[ 5.58500.3, 5.58500.4 ],
[ 5.187200.24, 5.187200.8 ],
[ 5.187200.49, 5.187200.35 ],
[ 5.1872000.29, 5.1872000.17 ],
[ 5.720000.1, 5.720000.2 ],
[ 5.390000.3, 5.390000.28 ],
[ 5.1170000.23, 5.1170000.25 ],
[ 5.936000.20, 5.936000.17 ],
[ 5.374400.5, 5.374400.27, 5.374400.38, 5.374400.23 ],
[ 5.18720.1, 5.18720.5 ],
[ 5.187200.29, 5.187200.32, 5.187200.16, 5.187200.13 ],
[ 5.3120.1, 5.3120.2 ],
[ 5.468000.35, 5.468000.31 ],
[ 5.374400.7, 5.374400.28 ],
[ 5.78000.10, 5.78000.12 ],
[ 5.468000.2, 5.468000.4 ],
[ 5.374400.36, 5.374400.18 ],
[ 5.374400.37, 5.374400.25, 5.374400.19 ],
[ 5.74880.4, 5.74880.16 ],
[ 5.18720.45, 5.18720.46 ],
[ 5.156000.2, 5.156000.4 ],
[ 5.18720.10, 5.18720.12 ],
[ 5.936000.24, 5.936000.12 ],
[ 5.468000.1, 5.468000.3 ],
[ 5.936000.42, 5.936000.38 ],
[ 5.234000.3, 5.234000.5 ],
[ 5.37440.15, 5.37440.17 ],
[ 5.93600.69, 5.93600.71 ],
[ 5.468000.68, 5.468000.66 ],
[ 5.124800.2, 5.124800.4 ],
[ 5.936000.41, 5.936000.43, 5.936000.36, 5.936000.39 ],
[ 5.624.2, 5.624.4 ],
[ 5.936000.28, 5.936000.16 ],
[ 5.74880.1, 5.74880.19, 5.74880.10, 5.74880.14 ],
[ 5.7488.20, 5.7488.22, 5.7488.24, 5.7488.18, 5.7488.3, 5.7488.4, 5.7488.7, 5.7488.8 ],
[ 5.78000.5, 5.78000.6 ],
[ 5.468000.36, 5.468000.32 ],
[ 5.46800.26, 5.46800.28 ],
[ 5.1872000.28, 5.1872000.15 ],
[ 5.312000.14, 5.312000.13 ],
[ 5.93600.19, 5.93600.14 ],
[ 5.93600.49, 5.93600.36 ],
[ 5.374400.33, 5.374400.10 ],
[ 5.390000.50, 5.390000.37 ],
[ 5.3744.9, 5.3744.22, 5.3744.23, 5.3744.26, 5.3744.27, 5.3744.10, 5.3744.13, 5.3744.14 ],
[ 5.18720.2, 5.18720.6 ],
[ 5.18720.11, 5.18720.9 ],
[ 5.156000.16, 5.156000.13 ],
[ 5.74880.18, 5.74880.6 ],
[ 5.46800.1, 5.46800.2 ],
[ 5.468000.65, 5.468000.67 ],
[ 5.7488.21, 5.7488.23, 5.7488.19, 5.7488.17, 5.7488.1, 5.7488.2, 5.7488.5, 5.7488.6 ],
[ 5.936000.40, 5.936000.35 ],
[ 5.46800.3, 5.46800.5 ],
[ 5.1560.3, 5.1560.4 ],
[ 5.390000.12, 5.390000.13 ],
[ 5.48750.5, 5.48750.6 ],
[ 5.374400.9, 5.374400.34, 5.374400.11 ],
[ 5.6240.20, 5.6240.19 ],
[ 5.93600.22, 5.93600.17 ],
[ 5.1872000.8, 5.1872000.24 ],
[ 5.93600.50, 5.93600.38 ],
[ 5.195000.16, 5.195000.17 ],
[ 5.117000.3, 5.117000.2 ],
[ 5.187200.27, 5.187200.11 ],
[ 5.312000.5, 5.312000.6 ],
[ 5.624.1, 5.624.3 ],
[ 5.187200.30, 5.187200.14 ],
[ 5.3744.7, 5.3744.17 ],
[ 5.468000.56, 5.468000.49 ],
[ 5.37440.23, 5.37440.22 ],
[ 5.187200.51, 5.187200.45, 5.187200.46, 5.187200.40, 5.187200.41 ],
[ 5.234000.34, 5.234000.35 ],
[ 5.9360.13, 5.9360.15 ],
[ 5.187200.18, 5.187200.2 ],
[ 5.93600.45, 5.93600.32 ],
[ 5.12480.19, 5.12480.17 ],
[ 5.187200.47, 5.187200.33 ],
[ 5.12480.13, 5.12480.14 ],
[ 5.12480.20, 5.12480.18 ],
[ 5.4680.5, 5.4680.6 ],
[ 5.93600.7, 5.93600.11 ],
[ 5.3744.1, 5.3744.3, 5.3744.21, 5.3744.25 ],
[ 5.374400.2, 5.374400.29, 5.374400.26, 5.374400.12 ],
[ 5.31200.7, 5.31200.8 ],
[ 5.468000.29, 5.468000.33 ],
[ 5.468000.21, 5.468000.23 ],
[ 5.14976.14, 5.14976.16, 5.14976.5, 5.14976.8 ],
[ 5.3120.9, 5.3120.10 ],
[ 5.9360.25, 5.9360.27 ],
[ 5.468000.53, 5.468000.42 ],
[ 5.936000.45, 5.936000.32 ],
[ 5.37440.19, 5.37440.13 ],
[ 5.1872000.2, 5.1872000.18 ],
[ 5.46800.4, 5.46800.6 ],
[ 5.74880.22, 5.74880.3, 5.74880.12, 5.74880.15 ],
[ 5.124800.5, 5.124800.6 ],
[ 5.9360.28, 5.9360.29 ],
[ 5.156000.14, 5.156000.17 ],
[ 5.374400.24, 5.374400.17 ],
[ 5.1872.1, 5.1872.2, 5.1872.5, 5.1872.6 ],
[ 5.936000.44, 5.936000.31 ],
[ 5.124800.1, 5.124800.3 ],
[ 5.1170000.29, 5.1170000.8 ],
[ 5.374400.35, 5.374400.16 ],
[ 5.187200.28, 5.187200.12 ],
[ 5.234000.37, 5.234000.38 ],
[ 5.936000.25, 5.936000.13 ],
[ 5.37440.3, 5.37440.9 ],
[ 5.18720.20, 5.18720.26 ],
[ 5.374400.30, 5.374400.13 ],
[ 5.1872000.27, 5.1872000.10 ],
[ 5.18720.49, 5.18720.48 ],
[ 5.312.1, 5.312.2 ],
[ 5.374400.1, 5.374400.3, 5.374400.20, 5.374400.21 ],
[ 5.37440.26, 5.37440.28 ],
[ 5.468000.55, 5.468000.47 ],
[ 5.468000.52, 5.468000.41 ],
[ 5.3744.11, 5.3744.12, 5.3744.15, 5.3744.16 ],
[ 5.46800.15, 5.46800.16 ],
[ 5.7488.10, 5.7488.11, 5.7488.13, 5.7488.14 ],
[ 5.1872000.25, 5.1872000.12 ],
[ 5.37440.11, 5.37440.5 ],
[ 5.12480.5, 5.12480.6 ],
[ 5.187200.54, 5.187200.50, 5.187200.36 ],
[ 5.156000.1, 5.156000.3 ],
[ 5.9360.1, 5.9360.3 ],
[ 5.3744.5, 5.3744.6, 5.3744.20, 5.3744.19 ],
[ 5.93600.6, 5.93600.10 ],
[ 5.62400.5, 5.62400.6 ],
[ 5.93600.8, 5.93600.12 ],
[ 5.3120.6, 5.3120.8 ],
[ 5.1872.3, 5.1872.4 ],
[ 5.37440.18, 5.37440.16 ],
[ 5.62400.10, 5.62400.12 ],
[ 5.936000.10, 5.936000.11 ],
[ 5.93600.47, 5.93600.34 ],
[ 5.468000.28, 5.468000.26 ],
[ 5.6240.14, 5.6240.17 ],
[ 5.187200.42, 5.187200.37 ],
[ 5.624000.2, 5.624000.4 ],
[ 5.390000.31, 5.390000.32 ],
[ 5.624000.1, 5.624000.3 ],
[ 5.1872000.21, 5.1872000.14 ],
[ 5.468000.44, 5.468000.45 ],
[ 5.18720.24, 5.18720.18 ],
[ 5.37440.12, 5.37440.6 ],
[ 5.780000.17, 5.780000.18 ],
[ 5.93600.55, 5.93600.54, 5.93600.26 ],
[ 5.93600.2, 5.93600.4 ],
[ 5.1872000.9, 5.1872000.6 ],
[ 5.3744.2, 5.3744.4, 5.3744.24, 5.3744.28 ],
[ 5.37440.2, 5.37440.8 ],
[ 5.936000.21, 5.936000.7 ],
[ 5.936000.5, 5.936000.6 ],
[ 5.374400.4, 5.374400.31, 5.374400.32, 5.374400.22, 5.374400.14, 5.374400.15 ],
[ 5.936000.23, 5.936000.9 ],
[ 5.3120.5, 5.3120.7 ],
[ 5.93600.58, 5.93600.21, 5.93600.16 ],
[ 5.468000.24, 5.468000.22 ],
[ 5.93600.18, 5.93600.13 ],
[ 5.312000.20, 5.312000.18 ],
[ 5.1170000.30, 5.1170000.2 ],
[ 5.93600.43, 5.93600.30 ],
[ 5.936000.22, 5.936000.8 ],
[ 5.93600.42, 5.93600.51, 5.93600.39 ],
[ 5.93600.5, 5.93600.9 ],
[ 5.624.5, 5.624.6 ],
[ 5.1872000.4, 5.1872000.1, 5.1872000.19, 5.1872000.11 ],
[ 5.1872000.5, 5.1872000.20, 5.1872000.23, 5.1872000.30 ],
[ 5.234000.4, 5.234000.6 ],
[ 5.7488.12, 5.7488.15, 5.7488.16, 5.7488.9 ],
[ 5.18720.39, 5.18720.37 ],
[ 5.187200.43, 5.187200.38 ],
[ 5.260000.16, 5.260000.11 ],
[ 5.585000.28, 5.585000.25 ],
[ 5.3744.8, 5.3744.18 ],
[ 5.312000.17, 5.312000.19 ],
[ 5.468000.70, 5.468000.69 ],
[ 5.468000.20, 5.468000.11 ],
[ 5.6240.5, 5.6240.6 ],
[ 5.93600.57, 5.93600.29 ],
[ 5.14976.11, 5.14976.13, 5.14976.15, 5.14976.1, 5.14976.4, 5.14976.6, 5.14976.7, 5.14976.9 ],
[ 5.468000.54, 5.468000.43 ],
[ 5.7800.2, 5.7800.3 ],
[ 5.187200.21, 5.187200.5 ],
[ 5.468000.7, 5.468000.8 ],
[ 5.234000.11, 5.234000.13 ],
[ 5.6240.13, 5.6240.16 ],
[ 5.93600.41, 5.93600.37 ],
[ 5.187200.19, 5.187200.3 ],
[ 5.195000.18, 5.195000.19 ],
[ 5.93600.40, 5.93600.52 ],
[ 5.18720.4, 5.18720.8 ],
[ 5.24960.2, 5.24960.4 ],
[ 5.936000.27, 5.936000.15 ],
[ 5.936000.29, 5.936000.18 ],
[ 5.390000.29, 5.390000.33 ],
[ 5.187200.31, 5.187200.15 ],
[ 5.187200.20, 5.187200.23, 5.187200.4, 5.187200.7 ],
[ 5.93600.1, 5.93600.3 ],
[ 5.31200.1, 5.31200.2 ],
[ 5.46800.10, 5.46800.12 ],
[ 5.74880.20, 5.74880.8 ],
[ 5.74880.21, 5.74880.9 ],
[ 5.14976.10, 5.14976.12, 5.14976.2, 5.14976.3 ],
[ 5.93600.70, 5.93600.72 ],
[ 5.117000.5, 5.117000.6 ],
[ 5.9360.12, 5.9360.14 ],
[ 5.936000.30, 5.936000.19 ],
[ 5.9360.16, 5.9360.17 ],
[ 5.156000.20, 5.156000.19 ],
[ 5.62400.9, 5.62400.11 ],
[ 5.187200.52, 5.187200.53 ],
[ 5.2340000.18, 5.2340000.16 ],
[ 5.468000.57, 5.468000.50 ],
[ 5.6240.2, 5.6240.4 ],
[ 5.780000.3, 5.780000.14 ],
[ 5.15600.3, 5.15600.5 ],
[ 5.187200.25, 5.187200.9 ],
[ 5.234000.14, 5.234000.12 ],
[ 5.187200.26, 5.187200.10 ],
[ 5.93600.75, 5.93600.74 ],
[ 5.93600.44, 5.93600.31 ],
[ 5.9360.2, 5.9360.4 ],
[ 5.1872000.3, 5.1872000.22, 5.1872000.26, 5.1872000.13 ],
[ 5.18720.22, 5.18720.28 ],
[ 5.4680.10, 5.4680.9 ],
[ 5.37440.10, 5.37440.4 ],
[ 5.234000.40, 5.234000.42 ],
[ 5.9360.24, 5.9360.26 ],
[ 5.624000.5, 5.624000.6 ],
[ 5.62400.1, 5.62400.2 ],
[ 5.156000.5, 5.156000.6 ],
[ 5.78000.9, 5.78000.11 ],
[ 5.18720.3, 5.18720.7 ],
[ 5.15600.4, 5.15600.6 ],
[ 5.260000.22, 5.260000.15 ],
[ 5.360000.1, 5.360000.2 ],
[ 5.37440.1, 5.37440.7 ],
[ 5.234000.41, 5.234000.39 ],
[ 5.37440.20, 5.37440.14 ],
[ 5.780000.34, 5.780000.11 ],
[ 5.585000.18, 5.585000.19 ],
[ 5.234000.32, 5.234000.33 ],
[ 5.24960.5, 5.24960.6 ],
[ 5.37440.25, 5.37440.27 ],
[ 5.46800.25, 5.46800.27 ],
[ 5.24960.1, 5.24960.3 ],
[ 5.374400.6, 5.374400.8 ],
[ 5.93600.46, 5.93600.48, 5.93600.33, 5.93600.35 ],
[ 5.18720.38, 5.18720.36 ],
[ 5.468000.34, 5.468000.30 ],
[ 5.468000.51, 5.468000.46 ],
[ 5.93600.20, 5.93600.15 ],
[ 5.18720.33, 5.18720.34 ],
[ 5.187200.44, 5.187200.39 ],
[ 5.468000.25, 5.468000.27 ],
[ 5.18720.21, 5.18720.27 ],
[ 5.6240.1, 5.6240.3 ],
[ 5.187200.48, 5.187200.34 ],
[ 5.9360.9, 5.9360.10 ],
[ 5.74880.2, 5.74880.11 ],
[ 5.936000.46, 5.936000.34 ],
[ 5.39000.13, 5.39000.14 ],
[ 5.187200.22, 5.187200.6 ],
[ 5.74880.7, 5.74880.17 ],
[ 5.187200.17, 5.187200.1 ],
[ 5.780000.35, 5.780000.30 ],
[ 5.18720.25, 5.18720.19 ],
[ 5.780000.15, 5.780000.19 ],
[ 5.936000.26, 5.936000.14 ],
[ 5.234000.1, 5.234000.2 ]
]
*/

maxptsoverQ := [[max_pts_over_ext(H,1) where H is X[y]`subgroup : y in x] : x in Gassmanndups_lbls];
maxptsoverQ;
/*
*/

Gassmanndups_lbls1 := [Gassmanndups_lbls[i] : i in [1..#Gassmanndups_lbls] | #maxptsoverQ[i] ne #Set(maxptsoverQ[i])];
{*#x : x in Gassmanndups_lbls1 *};
// 
Gassmanndups_lbls1;
/*
*/

SG := Symp(4,5);
maxptsoversmalldegextns := [[<max_pts_over_ext(H,n) : n in [1..3]> cat <max_pts_over_ext(H meet SG,1)> cat <max_pts_over_ext(H,n : normal := true) : n in [1..3]> where H is X[y]`subgroup : y in x] : x in Gassmanndups_lbls1];
maxptsoversmalldegextns;
/*
*/

Gassmanndups_lbls2 := [Gassmanndups_lbls1[i] : i in [1..#Gassmanndups_lbls1] | #maxptsoversmalldegextns[i] ne #Set(maxptsoversmalldegextns[i])];
{*#x : x in Gassmanndups_lbls2 *};
// 
Gassmanndups_lbls2;
/*
*/

isGLconjugate := [IsConjugate(GL(4,Integers(5)),H1,H2) where H1, H2 is Explode([X[y]`subgroup : y in x]) : x in Gassmanndups_lbls | #x eq 2];
isGLconjugate;
SequenceToMultiset(isGLconjugate);
// {* false^^215, true^^25 *}
GLconjugatesubs := [x : x in Gassmanndups_lbls | #x eq 2 and IsConjugate(GL(4,Integers(5)),H1,H2) where H1, H2 is Explode([X[y]`subgroup : y in x])];
/*
[
[ 5.720000.1, 5.720000.2 ],
[ 5.390000.3, 5.390000.28 ],
[ 5.1170000.23, 5.1170000.25 ],
[ 5.390000.50, 5.390000.37 ],
[ 5.390000.12, 5.390000.13 ],
[ 5.48750.5, 5.48750.6 ],
[ 5.195000.16, 5.195000.17 ],
[ 5.1170000.29, 5.1170000.8 ],
[ 5.390000.31, 5.390000.32 ],
[ 5.780000.17, 5.780000.18 ],
[ 5.1170000.30, 5.1170000.2 ],
[ 5.260000.16, 5.260000.11 ],
[ 5.585000.28, 5.585000.25 ],
[ 5.468000.70, 5.468000.69 ],
[ 5.468000.20, 5.468000.11 ],
[ 5.195000.18, 5.195000.19 ],
[ 5.390000.29, 5.390000.33 ],
[ 5.2340000.18, 5.2340000.16 ],
[ 5.780000.3, 5.780000.14 ],
[ 5.260000.22, 5.260000.15 ],
[ 5.360000.1, 5.360000.2 ],
[ 5.780000.34, 5.780000.11 ],
[ 5.585000.18, 5.585000.19 ],
[ 5.780000.35, 5.780000.30 ],
[ 5.780000.15, 5.780000.19 ]
]
*/
orders_GLconjugatesubs := [#G/X[x[1]]`index : x in GLconjugatesubs];
Sort(orders_GLconjugatesubs);
// [ 16, 32, 32, 32, 48, 48, 48, 48, 48, 52, 64, 64, 80, 80, 96, 96, 96, 96, 96, 104, 144, 144, 192, 192, 768 ]


groupid := [[IdentifyGroup(X[y]`subgroup) : y in x] : x in Gassmanndups_lbls2];
groupid;
/*
*/

negativeone := G!ScalarMatrix(4,-1);
negativeonesub := sub<G|negativeone>;
projgroupid := [[<y,IdentifyGroup(quo<H|negativeonesub>)> : y in x | negativeone in H where H is X[y]`subgroup] : x in Gassmanndups_lbls2[[1,4,6]]];
projgroupid;
/*
*/

maxptsoverlargedegextns := [[<max_pts_over_ext(H,n) : n in [6,8,12]> where H is X[y]`subgroup : y in x] : x in Gassmanndups_lbls2[[1,4,6]]];
maxptsoverlargedegextns;
/*
*/

groupid := [[IdentifyGroup(X[y]`subgroup) : y in x] : x in Gassmanndups_lbls2[[2,3,5,7,8]]];
groupid;
/*
*/